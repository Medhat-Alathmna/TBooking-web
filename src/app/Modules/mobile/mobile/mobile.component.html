<app-loading *ngIf="loading" display="full"></app-loading>
<p-toast position="top-right"></p-toast>
<p-confirmDialog appendTo="body"></p-confirmDialog>
<div style="height:calc(100vh - 68px) ;" class="  pt-0 card ">
    <p-tabMenu class="col-12" [model]="tabIndex" [activeItem]="tabIndex[0]"></p-tabMenu>
    <div *ngIf="tabSelected=='service'" class=" grid col-12">
        <p-table #kt [value]="services" [scrollable]="true" scrollHeight="80vh" class="col-12" [rowHover]="true">
            <ng-template pTemplate="caption">
                <div class="flex align-items-center justify-content-between">
                    <div>
                        <h5 class="m-0 primary" translate >Services Management</h5>
                        <label class="text-600 ">
                            In total there are <label class="text-primary font-bold ">
                                {{services ? services.length : 0 }}</label> Services .
                        </label>
                    </div>
                    <div class="table-header inputgroup-stopwords block ">
                        <div class="p-inputgroup inputgroup-stopwords">
                            <div>
                                <button type="button" (click)="showcreateDialog()" label="Add Service" pRipple pButton
                                    icon="pi pi-plus" class="p-button-success "></button>
                            </div>
                        </div>
                    </div>
                </div>
            </ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th>Services</th>
                    <th style="width: 10% !important">Actions</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-ser let-i="rowIndex">
                <tr>
                    <td style="width: 20%">
                        <span class="text-2xl text-primary pointer bold" (click)="showServices(ser)">
                            {{lang=='en'? ser?.service_en:ser?.service_ar}}
                        </span>
                    </td>
                    <td style="width: 10%">
                        <button pButton pRipple icon="pi pi-pencil text-base" (click)="showServices(ser)"
                          class="p-button-sm  p-button-primary mr-1"></button>
                        <button pButton pRipple icon="pi pi-power-off text-base"
                            class="p-button-sm  p-button-danger mr-1 "></button>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="4">No Services .</td>
                </tr>
            </ng-template>
        </p-table>
    </div>



    <div *ngIf="tabSelected=='home'" class="grid"></div>
</div>

<p-dialog header="Create the service" modal="true" [resizable]="false" [draggable]="false" [(visible)]="showAddServ"
    [style]="{width: '30vw'}">
    <div class="grid textl-left">
        <div class=" lg:col-6  sm:col-12">
            <app-input [(ngModel)]="Service.service_en" name="titleEn" title="Services EN"
                [required]="true"></app-input>
        </div>
        <div class=" lg:col-6  sm:col-12">
            <app-input [(ngModel)]="Service.service_ar" name="titleEn" title="Services AR"
                [required]="true"></app-input>
        </div>
    </div>
    <p-footer>
        <button type="button" pButton (click)="createService()" label='Create'></button>
        <button type="button" (click)="showAddServ=false" class="p-button-secondary " pButton label='Cancel'></button>
    </p-footer>
</p-dialog>

<p-dialog header="Modify the Sub Services" modal="true" [resizable]="false" [draggable]="false" [(visible)]="showAEditSubServ"
    [style]="{width: '30vw'}">
    <div class="grid textl-left">
        <div class=" lg:col-6  sm:col-12">
            <app-input [(ngModel)]="editSubService.name_en" name="titleEn" title="Sub Services EN"
                [required]="true"></app-input>
        </div>
        <div class=" lg:col-6  sm:col-12">
            <app-input [(ngModel)]="editSubService.name_ar" name="titleAr" title="Sub Services AR"
                [required]="true"></app-input>
        </div>
    </div>
    <p-footer>
        <button type="button" (click)="updateSubService()" pButton  label='Update'></button>
        <button type="button" class="p-button-danger" pButton label='Delete'></button>

        <button type="button" (click)="showAEditSubServ=false" class="p-button-secondary " pButton label='Cancel'></button>
    </p-footer>
</p-dialog>


<p-dialog header="Services Info" modal="true" [resizable]="false" [draggable]="false" [(visible)]="showEditServ"
    [style]="{width: '60vw',height:'70vh'}">
  
<div class="grid">
    <div class=" lg:col-6  sm:col-12">
        <app-input [(ngModel)]="Service.service_en" name="titleEn" title="Services EN"
            [required]="true"></app-input>
    </div>
    <div class=" lg:col-6  sm:col-12">
        <app-input [(ngModel)]="Service.service_ar" name="titleEn" title="Services AR"
            [required]="true"></app-input>
    </div>
</div>
<div class="grid mt-2">
    <div class=" lg:col-6  sm:col-12">
        <app-input (keydown)="insertKeyWord($event)" [(ngModel)]="SubService.name_en" name="titleEn" title="Sub Services EN"
            [required]="true"></app-input>
           
    </div>
    <div class=" lg:col-6  sm:col-12">
        <app-input (keydown)="insertKeyWord($event)" [(ngModel)]="SubService.name_ar" name="titleEn" title="Sub Services AR"
            [required]="true"></app-input>
           
    </div>
    <div style="display: inline-grid;">
        <span style="
    width: -webkit-fill-available;color:var(--surface-600) !important">* Press <label
                style="color: var(--primary-color);">Enter</label> to Add Sub Service</span>

        <label class="text-600; ">
            * In total there are <label class="text-primary font-bold ">
                {{Subservices ? Subservices.length : 0 }}</label> Sub Services .
        </label>
    </div>
</div>

    <div class=" flex-column mt-2 col-12">
        <div class="content-section p-fluid flex col-6" *ngFor="let key of Subservices; let i=index" (click)="showEditSub(key,i)" >
            <p-tag 
                tooltipPosition="top" showDelay="1000" hideDelay="500" 
                severity='success' class="pl-1 font-bold text-2xl pointer" [value]="key.name_en"
                ></p-tag>
            <p-tag
                tooltipPosition="top" showDelay="1000" hideDelay="500" 
                severity='Primary' class="pl-1 text-2xl font-bold pointer" [value]="key.name_ar"
                ></p-tag>
        </div>
    </div>
    <p-footer>
        <button type="button" (click)="updateService()" pButton label='Update Service'></button>
        <button type="button" (click)="showEditServ=false" class="p-button-secondary p-button-outlined" pButton
            label='Cancel'></button>
    </p-footer>
</p-dialog>