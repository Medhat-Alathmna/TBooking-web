
<app-loading *ngIf="loading" display="full"></app-loading>
<p-toast position="top-right"></p-toast>
<p-confirmDialog containerStyleClass="vw" acceptButtonStyleClass="p-button-danger" acceptIcon="pi pi-trash"
    rejectButtonStyleClass="p-button-text" appendTo="body"></p-confirmDialog>
<div class="grid card" style="height:calc(100vh - 68px) ;">
    <p-table #kt [value]="orders"  (onPage)="getOrders(($event?.first/rowNum)+1)"
    [paginator]="true" [rows]='rowNum' currentPageReportTemplate="Showing {first} to {last} entries"
    [scrollable]="true" [tableStyle]="{'width.%': 100}" scrollHeight="80vh">
        <ng-template pTemplate="caption">
            <div class="flex align-items-center justify-content-between">
                <div>
                    <h5 class="m-0 primary">Orders Manager</h5>
                    <label class="text-600 ">
                        In total there are <label class="text-primary font-bold ">
                            {{orders ? orders.length : 0 }}</label> Orders .
                    </label>
                </div>
                <!-- <div class="table-header inputgroup-stopwords block ">
                    <div class="p-inputgroup inputgroup-stopwords">
                        <div>
                            <button type="button" (click)="showUserSide()" label="Add Order" pRipple pButton
                                icon="pi pi-plus" class="p-button-success "></button>
                        </div>
                    </div>
                </div> -->
            </div>
        </ng-template>
        <ng-template pTemplate="header">
            <tr>
                <th style="width: 30vw">Order No.</th>
                <th style="width: 30vw">Customer</th>
                <th>Appointment No.</th>
                <th>Total Price</th>
                <th>Creation Date</th>
                <th style="width: 10% !important">Actions</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-ser let-i="rowIndex">
            <tr>
                <td style="width: 30vw">
                    <span (click)="getOrder(ser)" class="text-xl text-primary pointer font-bold">
                        {{ser.attributes.orderNo}}
                    </span>
                </td>
                <td style="width: 30vw">
                    <span  (click)="getOrder(ser)" class="text-xl text-primary pointer ">
                        {{ser.attributes.appointment.data.attributes.customer.firstName}}
                        {{ser.attributes.appointment.data.attributes.customer.middleName}}
                        {{ser.attributes.appointment.data.attributes.customer.lastName}}
                    </span>
                </td>
                <td>
                    <span class="text-xl text-primary ">
                        {{ser.attributes.appointment.data.attributes.number}}
                    </span>
                </td>
                <td>
                    <span class="text-xl text-primary  bold">
                        <span>{{ser?.attributes.totalPrice}} / JOD</span>
                    </span>
                </td>
                <td>
                    <span class="text-xl text-primary  bold">
                        {{ ser?.attributes.createdAt| date: 'dd/MM/yyyy hh:mm' }}
                    </span>
                   
                </td>
                <td style="width: 10%">
                    <button (click)="showUserDeatil(ser)" pButton pRipple icon="pi pi-pencil text-base"
                        class="p-button-sm  p-button-primary mr-1"></button>
                    <button  pButton pRipple icon="pi pi-trash text-base"
                        class="p-button-sm mr-1 p-button-danger "></button>
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
            <tr>
                <td colspan="4">No Services .</td>
            </tr>
        </ng-template>
    </p-table>
</div>


 <app-add-edit-order *ngIf="showOrderSidebar" (refreshLish)="getOrders(1,null,false)" [selectedOrder]="selectedOrder"
    [id]="id" [detailMode]="detailMode" [(display)]="showOrderSidebar"></app-add-edit-order>